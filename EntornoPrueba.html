<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Scroll Story</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=SF+Pro+Display:wght@100;200;300;400;600&display=swap');
    @import url('https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,300;0,400;1,300&family=Inter:wght@200;300;400&display=swap');

    :root {
      --white: #f5f5f7;
      --black: #000000;
      --gray: #6e6e73;
      --light-gray: #d2d2d7;
      --accent: #0071e3;
    }

    *, *::before, *::after {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html {
      scroll-behavior: auto;
    }

    body {
      background: #000;
      color: var(--white);
      font-family: -apple-system, BlinkMacSystemFont, "SF Pro Display", "SF Pro Text", Inter, system-ui, sans-serif;
      overflow-x: hidden;
      cursor: none;
      -webkit-font-smoothing: antialiased;
      text-rendering: optimizeLegibility;
    }

    /* ── Custom Cursor ── */
    #cursor {
      position: fixed;
      width: 10px;
      height: 10px;
      background: #fff;
      border-radius: 50%;
      pointer-events: none;
      z-index: 9999;
      transform: translate(-50%, -50%);
      transition: width .2s, height .2s, background .2s;
      mix-blend-mode: difference;
    }

    #cursor-ring {
      position: fixed;
      width: 36px;
      height: 36px;
      border: 1px solid rgba(255,255,255,0.5);
      border-radius: 50%;
      pointer-events: none;
      z-index: 9998;
      transform: translate(-50%, -50%);
      transition: transform .12s ease, width .25s, height .25s, border-color .25s;
    }

    body.cursor-hover #cursor { width: 16px; height: 16px; }
    body.cursor-hover #cursor-ring { width: 60px; height: 60px; border-color: rgba(255,255,255,0.3); }

    /* ── Sticky video scene ── */
    #scene {
      position: relative;
      height: 600vh; /* scroll space */
    }

    #sticky-wrap {
      position: sticky;
      top: 0;
      width: 100%;
      height: 100vh;
      overflow: hidden;
    }

    #bg-video {
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
      opacity: 0.85;
    }

    /* Fallback gradient if video unavailable */
    #fallback-canvas {
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
      display: none;
    }

    /* ── Overlay gradient ── */
    .vignette {
      position: absolute;
      inset: 0;
      background: radial-gradient(ellipse at center, transparent 40%, rgba(0,0,0,0.65) 100%);
      pointer-events: none;
      z-index: 2;
    }

    .bottom-fade {
      position: absolute;
      bottom: 0; left: 0; right: 0;
      height: 35vh;
      background: linear-gradient(to bottom, transparent, #000);
      pointer-events: none;
      z-index: 2;
    }

    .top-fade {
      position: absolute;
      top: 0; left: 0; right: 0;
      height: 15vh;
      background: linear-gradient(to top, transparent, #000);
      pointer-events: none;
      z-index: 2;
    }

    /* ── Nav ── */
    nav {
      position: fixed;
      top: 0; left: 0; right: 0;
      z-index: 1000;
      padding: 20px 48px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    nav::before {
      content: '';
      position: absolute;
      inset: 0;
      background: linear-gradient(to bottom, rgba(0,0,0,0.5), transparent);
      pointer-events: none;
    }

    .nav-logo {
      font-family: 'Playfair Display', Georgia, serif;
      font-weight: 300;
      font-size: 22px;
      letter-spacing: .04em;
      color: #fff;
      position: relative;
    }

    .nav-links {
      display: flex;
      gap: 36px;
      list-style: none;
      position: relative;
    }

    .nav-links a {
      color: rgba(255,255,255,0.7);
      text-decoration: none;
      font-size: 13px;
      font-weight: 300;
      letter-spacing: .05em;
      transition: color .25s;
    }

    .nav-links a:hover { color: #fff; }

    /* ── Story text layers ── */
    .story-layer {
      position: absolute;
      inset: 0;
      z-index: 10;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-direction: column;
      text-align: center;
      padding: 0 24px;
      opacity: 0;
      transform: translateY(30px);
      pointer-events: none;
      transition: none;
    }

    .story-layer.active {
      pointer-events: auto;
    }

    .story-layer .eyebrow {
      font-size: 11px;
      font-weight: 400;
      letter-spacing: .18em;
      text-transform: uppercase;
      color: var(--accent);
      margin-bottom: 20px;
    }

    .story-layer h1 {
      font-family: -apple-system, BlinkMacSystemFont, "SF Pro Display", "SF Pro Text", Inter, system-ui, sans-serif;
      font-weight: 600;
      letter-spacing: -0.025em;
      font-size: clamp(48px, 8vw, 96px);
      line-height: 1.05;
      letter-spacing: -.01em;
      color: #fff;
      max-width: 900px;
    }

    .story-layer h1 em {
      font-style: italic;
      color: var(--light-gray);
    }

    .story-layer p {
      margin-top: 28px;
      font-size: clamp(15px, 1.8vw, 20px);
      font-weight: 200;
      color: rgba(255,255,255,0.65);
      max-width: 600px;
      line-height: 1.7;
      letter-spacing: .01em;
    }

    .story-layer .cta {
      margin-top: 44px;
      display: inline-flex;
      align-items: center;
      gap: 10px;
      font-size: 14px;
      font-weight: 400;
      color: var(--accent);
      letter-spacing: .04em;
      border: 1px solid rgba(0,113,227,0.4);
      padding: 13px 32px;
      border-radius: 980px;
      backdrop-filter: blur(8px);
      background: rgba(0,113,227,0.08);
      cursor: pointer;
      pointer-events: auto;
      transition: background .3s, border-color .3s;
    }

    .story-layer .cta:hover {
      background: rgba(0,113,227,0.18);
      border-color: var(--accent);
    }

    .story-layer .cta svg {
      transition: transform .3s;
    }

    .story-layer .cta:hover svg { transform: translateX(4px); }

    /* stat cards */
    .stat-row {
      display: flex;
      gap: 40px;
      margin-top: 52px;
      flex-wrap: wrap;
      justify-content: center;
    }

    .stat {
      text-align: center;
      border: 1px solid rgba(255,255,255,0.12);
      border-radius: 18px;
      padding: 28px 36px;
      backdrop-filter: blur(16px);
      background: rgba(255,255,255,0.05);
      min-width: 130px;
    }

    .stat-num {
      font-family: 'Playfair Display', serif;
      font-size: 44px;
      font-weight: 300;
      color: #fff;
      line-height: 1;
    }

    .stat-label {
      font-size: 11px;
      font-weight: 400;
      letter-spacing: .12em;
      text-transform: uppercase;
      color: var(--gray);
      margin-top: 8px;
    }

    /* ── Scroll indicator ── */
    #scroll-hint {
      position: fixed;
      bottom: 36px;
      left: 50%;
      transform: translateX(-50%);
      z-index: 200;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 8px;
      opacity: 1;
      transition: opacity .5s;
    }

    #scroll-hint span {
      font-size: 10px;
      letter-spacing: .14em;
      text-transform: uppercase;
      color: rgba(255,255,255,0.4);
    }

    #scroll-hint .mouse {
      width: 22px;
      height: 34px;
      border: 1px solid rgba(255,255,255,0.3);
      border-radius: 11px;
      position: relative;
    }

    #scroll-hint .mouse::before {
      content: '';
      position: absolute;
      width: 3px;
      height: 6px;
      background: rgba(255,255,255,0.6);
      border-radius: 2px;
      left: 50%;
      top: 6px;
      transform: translateX(-50%);
      animation: scrollDot 1.8s ease-in-out infinite;
    }

    @keyframes scrollDot {
      0%   { opacity: 1; transform: translateX(-50%) translateY(0); }
      60%  { opacity: 0; transform: translateX(-50%) translateY(10px); }
      100% { opacity: 0; transform: translateX(-50%) translateY(0); }
    }

    /* ── Progress bar ── */
    #progress-bar {
      position: fixed;
      top: 0; left: 0;
      height: 2px;
      background: linear-gradient(90deg, var(--accent), #30d158);
      z-index: 2000;
      width: 0%;
      transition: width .08s linear;
    }

    /* ── Chapter dots ── */
    #chapter-dots {
      position: fixed;
      right: 28px;
      top: 50%;
      transform: translateY(-50%);
      z-index: 500;
      display: flex;
      flex-direction: column;
      gap: 14px;
    }

    .ch-dot {
      width: 6px;
      height: 6px;
      border-radius: 50%;
      background: rgba(255,255,255,0.25);
      transition: background .3s, transform .3s;
      cursor: pointer;
    }

    .ch-dot.active {
      background: #fff;
      transform: scale(1.4);
    }

    /* ── Post-scroll sections ── */
    .section {
      position: relative;
      z-index: 50;
      padding: 140px 48px;
      max-width: 1200px;
      margin: 0 auto;
    }

    .section-label {
      font-size: 11px;
      letter-spacing: .18em;
      text-transform: uppercase;
      color: var(--accent);
      margin-bottom: 24px;
    }

    .section h2 {
      font-family: 'Playfair Display', serif;
      font-weight: 300;
      font-size: clamp(36px, 5vw, 64px);
      line-height: 1.1;
      max-width: 800px;
      color: #fff;
    }

    .section h2 em { font-style: italic; color: var(--light-gray); }

    .section .body-text {
      margin-top: 32px;
      font-size: 17px;
      font-weight: 200;
      color: rgba(255,255,255,0.55);
      line-height: 1.8;
      max-width: 640px;
    }

    .feature-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 1px;
      margin-top: 80px;
      border: 1px solid rgba(255,255,255,0.08);
      border-radius: 24px;
      overflow: hidden;
    }

    .feature-card {
      padding: 48px;
      background: rgba(255,255,255,0.03);
      border-right: 1px solid rgba(255,255,255,0.08);
      border-bottom: 1px solid rgba(255,255,255,0.08);
      transition: background .3s;
    }

    .feature-card:hover { background: rgba(255,255,255,0.06); }

    .feature-icon {
      width: 48px;
      height: 48px;
      border-radius: 14px;
      background: rgba(0,113,227,0.15);
      border: 1px solid rgba(0,113,227,0.2);
      display: flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 28px;
      font-size: 22px;
    }

    .feature-card h3 {
      font-family: 'Playfair Display', serif;
      font-weight: 400;
      font-size: 22px;
      color: #fff;
      margin-bottom: 14px;
    }

    .feature-card p {
      font-size: 14px;
      font-weight: 300;
      color: rgba(255,255,255,0.5);
      line-height: 1.7;
    }

    footer {
      border-top: 1px solid rgba(255,255,255,0.08);
      padding: 60px 48px;
      max-width: 1200px;
      margin: 0 auto;
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
      gap: 24px;
    }

    footer .f-logo {
      font-family: 'Playfair Display', serif;
      font-weight: 300;
      font-size: 20px;
      color: rgba(255,255,255,0.5);
    }

    footer p {
      font-size: 12px;
      color: rgba(255,255,255,0.3);
      letter-spacing: .04em;
    }

    /* ── Noise overlay ── */
    body::after {
      content: '';
      position: fixed;
      inset: 0;
      pointer-events: none;
      z-index: 9997;
      opacity: 0.025;
      background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 512 512' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.75' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)'/%3E%3C/svg%3E");
      background-size: 200px;
    }
  </style>
</head>
<body>

<!-- Custom Cursor -->
<div id="cursor"></div>
<div id="cursor-ring"></div>

<!-- Progress -->
<div id="progress-bar"></div>

<!-- Nav -->
<nav>
  <div class="nav-logo">Santiago Sterling</div>
  <ul class="nav-links">
    <li><a href="#">Descubrir</a></li>
    <li><a href="#">Historia</a></li>
    <li><a href="#">Contacto</a></li>
  </ul>
</nav>

<!-- Chapter dots -->
<div id="chapter-dots">
  <div class="ch-dot active" data-ch="0"></div>
  <div class="ch-dot" data-ch="1"></div>
  <div class="ch-dot" data-ch="2"></div>
  <div class="ch-dot" data-ch="3"></div>
  <div class="ch-dot" data-ch="4"></div>
</div>

<!-- Scroll indicator -->
<div id="scroll-hint">
  <div class="mouse"></div>
  <span>Scroll</span>
</div>

<!-- ═══════════════════════════════════
     STICKY SCROLL SCENE
═══════════════════════════════════ -->
<div id="scene">
  <div id="sticky-wrap">

    <!-- Fallback animated canvas -->
    <canvas id="fallback-canvas"></canvas>

    <!-- Real video -->
    <video
      id="bg-video"
      src="https://assets.mixkit.co/videos/269/269-720.mp4"
      muted
      playsinline
      preload="auto"
    ></video>

    <div class="top-fade"></div>
    <div class="bottom-fade"></div>
    <div class="vignette"></div>

    <!-- Layer 0: Opening -->
    <div class="story-layer" id="layer-0">
      <div class="eyebrow">Capítulo I</div>
      <h1>El mundo en <em>movimiento</em></h1>
      <p>Todo comienza con un instante. Desliza para descubrir lo que existe más allá del horizonte.</p>
    </div>

    <!-- Layer 1: Reveal -->
    <div class="story-layer" id="layer-1">
      <div class="eyebrow">Capítulo II</div>
      <h1>La <em>naturaleza</em> nunca se detiene</h1>
      <p>Cada fotograma es un universo. Cada segundo, una historia que merece ser contada.</p>
      <div class="stat-row">
        <div class="stat">
          <div class="stat-num">∞</div>
          <div class="stat-label">Posibilidades</div>
        </div>
        <div class="stat">
          <div class="stat-num">24</div>
          <div class="stat-label">Fotogramas / s</div>
        </div>
        <div class="stat">
          <div class="stat-num">1</div>
          <div class="stat-label">Historia</div>
        </div>
      </div>
    </div>

    <!-- Layer 2: Middle -->
    <div class="story-layer" id="layer-2">
      <div class="eyebrow">Capítulo III</div>
      <h1>Cada <em>pixel</em> importa</h1>
      <p>La belleza vive en los detalles. En la luz que cambia, en la sombra que danza.</p>
    </div>

    <!-- Layer 3: Climax -->
    <div class="story-layer" id="layer-3">
      <div class="eyebrow">Capítulo IV</div>
      <h1>El tiempo <em>fluye</em><br/>como tú quieres</h1>
      <p>Controla la narrativa. Avanza, retrocede, explora cada momento a tu ritmo.</p>
    </div>

    <!-- Layer 4: End -->
    <div class="story-layer" id="layer-4">
      <div class="eyebrow">Epílogo</div>
      <h1>La historia<br/><em>eres tú</em></h1>
      <a class="cta" href="#">
        Explorar más
        <svg width="14" height="14" viewBox="0 0 14 14" fill="none">
          <path d="M1 7h12M8 2l5 5-5 5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </a>
    </div>

  </div>
</div>

<!-- ═══════════════════════════════════
     CONTENT BELOW SCROLL
═══════════════════════════════════ -->
<div style="background:#000; position:relative; z-index:60;">

  <div class="section">
    <div class="section-label">Experiencia</div>
    <h2>Diseñado para <em>sentir</em></h2>
    <p class="body-text">
      Cada elemento de esta experiencia fue creado con una sola intención: hacerte sentir algo real. El scroll no es navegación, es emoción.
    </p>

    <div class="feature-grid">
      <div class="feature-card">
        <div class="feature-icon">✦</div>
        <h3>Scroll sincronizado</h3>
        <p>El video avanza y retrocede con precisión milimétrica siguiendo cada pixel de tu scroll.</p>
      </div>
      <div class="feature-card">
        <div class="feature-icon">◎</div>
        <h3>Narrativa visual</h3>
        <p>Cinco capítulos que emergen y desaparecen en el momento exacto en que deben ser vistos.</p>
      </div>
      <div class="feature-card">
        <div class="feature-icon">⟡</div>
        <h3>Fluidez total</h3>
        <p>Animaciones de 60fps con interpolación suave. Cada transición se siente orgánica y natural.</p>
      </div>
    </div>
  </div>

  <footer>
    <div class="f-logo">Horizon</div>
    <p>© 2025 · Scroll Storytelling</p>
  </footer>

</div>

<script>
/* ═════════════════════════════════════════════
   CURSOR
═════════════════════════════════════════════ */
const cursor     = document.getElementById('cursor');
const cursorRing = document.getElementById('cursor-ring');
let mx = window.innerWidth / 2, my = window.innerHeight / 2;
let rx = mx, ry = my;

document.addEventListener('mousemove', e => { mx = e.clientX; my = e.clientY; });

;(function animCursor() {
  rx += (mx - rx) * 0.15;
  ry += (my - ry) * 0.15;
  cursor.style.left = mx + 'px';
  cursor.style.top  = my + 'px';
  cursorRing.style.left = rx + 'px';
  cursorRing.style.top  = ry + 'px';
  requestAnimationFrame(animCursor);
})();

document.querySelectorAll('a, button, .cta, .ch-dot, .feature-card').forEach(el => {
  el.addEventListener('mouseenter', () => document.body.classList.add('cursor-hover'));
  el.addEventListener('mouseleave', () => document.body.classList.remove('cursor-hover'));
});


/* ═════════════════════════════════════════════
   VIDEO + FALLBACK CANVAS
═════════════════════════════════════════════ */
const video   = document.getElementById('bg-video');
const canvas  = document.getElementById('fallback-canvas');
const ctx     = canvas.getContext('2d');
let videoReady = false;
let useFallback = false;

// Try to load the video; if it fails, use canvas fallback
video.addEventListener('loadeddata', () => { videoReady = true; });
video.addEventListener('error', activateFallback);
video.addEventListener('canplay', () => { videoReady = true; });

// Timeout safety: if video doesn't load in 4s, use fallback
setTimeout(() => {
  if (!videoReady) activateFallback();
}, 4000);

function activateFallback() {
  if (useFallback) return;
  useFallback = true;
  video.style.display = 'none';
  canvas.style.display = 'block';
  resizeCanvas();
  animateCanvas();
}

function resizeCanvas() {
  canvas.width  = window.innerWidth;
  canvas.height = window.innerHeight;
}

window.addEventListener('resize', () => { if (useFallback) resizeCanvas(); });

// Stunning animated fallback: deep-space nebula
let t = 0;
function animateCanvas() {
  if (!useFallback) return;
  requestAnimationFrame(animateCanvas);
  t += 0.003 * (1 + scrollProgress * 2);

  const w = canvas.width, h = canvas.height;
  ctx.clearRect(0, 0, w, h);

  // Base gradient
  const bg = ctx.createRadialGradient(w/2, h/2, 0, w/2, h/2, w * 0.9);
  const hue = (t * 30 + scrollProgress * 60) % 360;
  bg.addColorStop(0,   `hsla(${hue}, 60%, 10%, 1)`);
  bg.addColorStop(0.4, `hsla(${(hue + 40) % 360}, 50%, 5%, 1)`);
  bg.addColorStop(1,   'hsl(0, 0%, 1%)');
  ctx.fillStyle = bg;
  ctx.fillRect(0, 0, w, h);

  // Nebula blobs
  const blobs = [
    { x: 0.25, y: 0.35, r: 0.35, hOff: 0 },
    { x: 0.75, y: 0.60, r: 0.28, hOff: 120 },
    { x: 0.50, y: 0.20, r: 0.22, hOff: 240 },
  ];

  blobs.forEach(b => {
    const cx = w * (b.x + Math.sin(t + b.hOff) * 0.06);
    const cy = h * (b.y + Math.cos(t * 0.7 + b.hOff) * 0.04);
    const gr = ctx.createRadialGradient(cx, cy, 0, cx, cy, Math.min(w, h) * b.r);
    const bh = (hue + b.hOff) % 360;
    gr.addColorStop(0,   `hsla(${bh}, 80%, 55%, 0.18)`);
    gr.addColorStop(0.5, `hsla(${bh}, 70%, 40%, 0.06)`);
    gr.addColorStop(1,   'transparent');
    ctx.fillStyle = gr;
    ctx.fillRect(0, 0, w, h);
  });

  // Stars
  const seed = 42;
  for (let i = 0; i < 180; i++) {
    const sx = ((Math.sin(i * 127.1 + seed) * 0.5 + 0.5) * w + t * w * 0.01 * (i % 3 + 0.5)) % w;
    const sy = ((Math.sin(i * 311.7 + seed) * 0.5 + 0.5) * h);
    const sr = 0.4 + Math.abs(Math.sin(i * 91.3 + t)) * 1.2;
    const sa = 0.4 + Math.sin(i * 53.1 + t * 2) * 0.3;
    ctx.beginPath();
    ctx.arc(sx, sy, sr, 0, Math.PI * 2);
    ctx.fillStyle = `rgba(255,255,255,${sa})`;
    ctx.fill();
  }

  // Horizon glow
  const hgY = h * (0.55 + scrollProgress * 0.1);
  const hg  = ctx.createLinearGradient(0, hgY - 80, 0, hgY + 80);
  hg.addColorStop(0, 'transparent');
  hg.addColorStop(0.5, `hsla(${hue + 30}, 90%, 60%, ${0.12 + scrollProgress * 0.08})`);
  hg.addColorStop(1, 'transparent');
  ctx.fillStyle = hg;
  ctx.fillRect(0, hgY - 80, w, 160);
}


/* ═════════════════════════════════════════════
   SCROLL → VIDEO SCRUBBING
═════════════════════════════════════════════ */
const scene       = document.getElementById('scene');
const layers      = Array.from(document.querySelectorAll('.story-layer'));
const dots        = Array.from(document.querySelectorAll('.ch-dot'));
const scrollHint  = document.getElementById('scroll-hint');
const progressBar = document.getElementById('progress-bar');

let scrollProgress = 0;   // 0..1
let targetTime     = 0;
let currentTime    = 0;
let raf            = null;
const CHAPTERS     = layers.length;

function getScrollProgress() {
  const rect   = scene.getBoundingClientRect();
  const total  = scene.offsetHeight - window.innerHeight;
  const scrolled = Math.max(0, -rect.top);
  return Math.min(1, Math.max(0, scrolled / total));
}

function updateActiveChapter(p) {
  const idx = Math.min(CHAPTERS - 1, Math.floor(p * CHAPTERS));
  const frac = (p * CHAPTERS) - idx; // 0..1 within chapter

  layers.forEach((layer, i) => {
    const dist = Math.abs(i - p * (CHAPTERS - 1));
    let opacity, ty;

    if (i === idx) {
      if (frac < 0.15) {
        // Fade in
        opacity = frac / 0.15;
        ty = (1 - opacity) * 28;
      } else if (frac > 0.80) {
        // Fade out
        opacity = 1 - (frac - 0.80) / 0.20;
        ty = -(1 - opacity) * 28;
      } else {
        opacity = 1;
        ty = 0;
      }
    } else {
      opacity = 0;
      ty = i < idx ? -30 : 30;
    }

    layer.style.opacity   = Math.max(0, Math.min(1, opacity));
    layer.style.transform = `translateY(${ty}px)`;
    layer.classList.toggle('active', i === idx && opacity > 0.1);
  });

  dots.forEach((d, i) => d.classList.toggle('active', i === idx));
}

// Smooth time interpolation
function tick() {
  if (videoReady && video.duration) {
    const diff = targetTime - currentTime;
    currentTime += diff * 0.09;
    if (Math.abs(diff) > 0.001) {
      video.currentTime = Math.max(0, Math.min(video.duration, currentTime));
    }
  }
  raf = requestAnimationFrame(tick);
}

tick();

window.addEventListener('scroll', () => {
  scrollProgress = getScrollProgress();

  // Video scrub
  if (videoReady && video.duration) {
    targetTime = scrollProgress * video.duration;
  }

  // Chapter text
  updateActiveChapter(scrollProgress);

  // Progress bar
  progressBar.style.width = (scrollProgress * 100) + '%';

  // Scroll hint
  scrollHint.style.opacity = scrollProgress < 0.04 ? 1 : 0;
}, { passive: true });

// Chapter dot click → scroll
dots.forEach((dot, i) => {
  dot.addEventListener('click', () => {
    const p = i / (CHAPTERS - 1);
    const total = scene.offsetHeight - window.innerHeight;
    window.scrollTo({ top: p * total, behavior: 'smooth' });
  });
});

// Init first layer visible
window.dispatchEvent(new Event('scroll'));
updateActiveChapter(0);
layers[0].style.opacity = '1';
layers[0].style.transform = 'translateY(0)';
</script>
</body>
</html>
