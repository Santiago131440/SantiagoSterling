<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sterl-ink sketching</title>
<script src="https://cdn.tailwindcss.com"></script>

<style>
/* ===============================
   VARIABLES SISTEMA
================================ */
:root{
  --bg:#f2f2f7;
  --panel:#29C493cc;
  --border:#d1d1d6;
  --accent:#0a84ff;
  --text:#111;
  --shadow:0 20px 40px rgba(0,0,0,.18);
}

@media(prefers-color-scheme:dark){
  :root{
    --bg:#0d0d0f;
    --panel:#1c1c1ecc;
    --border:#2c2c2e;
    --text:#f5f5f7;
  }
}

*{
  box-sizing:border-box;
  user-select:none;
  -webkit-tap-highlight-color:transparent;
}

body{
  margin:0;
  height:100vh;
  overflow:hidden;
  background:var(--bg);
  color:var(--text);
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI";
}

/* ===============================
   CANVAS
================================ */
#viewport{
  position:absolute;
  inset:0;
  overflow:hidden;
}

#canvas{
  position:absolute;
  top:0;
  left:0;
  background:#fff;
  touch-action:none;
}

/* ===============================
   FLOATING PANELS
================================ */
.panel{
  position:fixed;
  background:var(--panel);
  backdrop-filter:blur(30px);
  border:1px solid var(--border);
  border-radius:18px;
  padding:14px;
  box-shadow:var(--shadow);
}

/* TOOLBAR */
#tools{
  left:14px;
  top:50%;
  transform:translateY(-50%);
  display:flex;
  flex-direction:column;
  gap:10px;
}

.tool{
  width:48px;
  height:48px;
  border-radius:60px;
  border:1px solid var(--border);
  background:#fff;
  font-size:22px;
  display:flex;
  align-items:center;
  justify-content:center;
  cursor:pointer;
}

.tool.active{
  background:var(--accent);
  color:white;
}

/* OPTIONS */
#options{
  right:14px;
  top:20px;
  width:220px;
  display:flex;
  flex-direction:column;
  gap:12px;
}

/* LAYERS */
#layers{
  right:14px;
  bottom:20px;
  width:220px;
}

.layer{
  padding:8px;
  border:1px solid var(--border);
  border-radius:10px;
  margin-bottom:6px;
  background:white;
  cursor:pointer;
}

.layer.active{
  border-color:var(--accent);
}

/* SLIDERS */
input[type=range]{
  width:100%;
}

/* ===============================
   DESKTOP
================================ */
@media(max-width:900px){
  #options,#layers{
    width:180px;
  }
}
</style>
</head>

<body>

<div id="viewport">
  <canvas id="canvas"></canvas>
</div>

<!-- TOOLS -->
<div class="panel" id="tools">
  <div class="tool active" data-tool="pen" name="L√°piz">‚úèÔ∏è</div>
  <div class="tool" data-tool="brush" name="Pincel">üñåÔ∏è</div>
  <div class="tool" data-tool="marker name="Marcador">üñäÔ∏è</div>
  <div class="tool" data-tool="eraser" name="Borrador">üßΩ</div>
  <div class="tool" data-tool="line" name="L√≠nea">üìè</div>
  <div class="tool" data-tool="rect" name="Cuadro">‚¨õ</div>
  <div class="tool" data-tool="circle" name="Circulo">‚ö™</div>
  <div class="tool" id="undo" name="Retroceder">‚Ü©Ô∏è</div>
  <div class="tool" id="redo" name="Rehacer">‚Ü™Ô∏è</div>
</div>

<!-- OPTIONS -->
<div class="panel" id="options">
  <p>Arte aut√©ntico + trazos limpios + libertad creativa</p>
  <label>Color <input type="color" id="color" value="#000000"></label>
  <label>Tama√±o <input type="range" id="size" min="1" max="40" value="6"></label>
  <button class="rounded rounded-full" id="save">Exportar PNG</button>
</div>


<script>
/* ===============================
   ENGINE
================================ */
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");
let dpr = window.devicePixelRatio || 1;

function resize(){
  canvas.width = innerWidth * dpr;
  canvas.height = innerHeight * dpr;
  canvas.style.width = innerWidth+"px";
  canvas.style.height = innerHeight+"px";
  ctx.setTransform(dpr,0,0,dpr,0,0);
}
resize();
addEventListener("resize",resize);

/* ===============================
   STATE
================================ */
let tool="pen";
let drawing=false;
let startX,startY;
let history=[],redoStack=[];
let layers=[{id:Date.now(),img:null}];
let activeLayer=0;

/* ===============================
   HISTORY
================================ */
function snapshot(){
  history.push(canvas.toDataURL());
  redoStack=[];
}

/* ===============================
   INPUT
================================ */
function pos(e){
  const r=canvas.getBoundingClientRect();
  const t=e.touches?e.touches[0]:e;
  return {x:t.clientX-r.left,y:t.clientY-r.top};
}

canvas.addEventListener("pointerdown",e=>{
  snapshot();
  drawing=true;
  const p=pos(e);
  startX=p.x; startY=p.y;
  ctx.beginPath();
  ctx.moveTo(p.x,p.y);
});

canvas.addEventListener("pointermove",e=>{
  if(!drawing) return;
  const p=pos(e);
  ctx.strokeStyle=tool==="eraser"?"#fff":color.value;
  ctx.lineWidth=size.value;
  ctx.lineCap="round";

  if(["pen","brush","marker","eraser"].includes(tool)){
    ctx.lineTo(p.x,p.y);
    ctx.stroke();
  }
});

canvas.addEventListener("pointerup",e=>{
  if(!drawing) return;
  drawing=false;
  const p=pos(e);
  ctx.closePath();

  if(tool==="line"){
    ctx.beginPath();
    ctx.moveTo(startX,startY);
    ctx.lineTo(p.x,p.y);
    ctx.stroke();
  }
  if(tool==="rect"){
    ctx.strokeRect(startX,startY,p.x-startX,p.y-startY);
  }
  if(tool==="circle"){
    ctx.beginPath();
    ctx.arc(startX,startY,Math.hypot(p.x-startX,p.y-startY),0,Math.PI*2);
    ctx.stroke();
  }
});

/* ===============================
   UI
================================ */
document.querySelectorAll(".tool[data-tool]").forEach(t=>{
  t.onclick=()=>{
    document.querySelectorAll(".tool").forEach(b=>b.classList.remove("active"));
    t.classList.add("active");
    tool=t.dataset.tool;
  };
});

undo.onclick=()=>{
  if(history.length){
    redoStack.push(history.pop());
    const img=new Image();
    img.src=history.at(-1);
    img.onload=()=>ctx.drawImage(img,0,0);
  }
};

redo.onclick=()=>{
  if(redoStack.length){
    const img=new Image();
    img.src=redoStack.pop();
    img.onload=()=>ctx.drawImage(img,0,0);
  }
};

save.onclick=()=>{
  const a=document.createElement("a");
  a.href=canvas.toDataURL("image/png");
  a.download="paint-pro.png";
  a.click();
};
</script>

</body>
</html>
